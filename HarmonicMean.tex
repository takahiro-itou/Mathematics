%%  -*-  coding:utf-8  -*-
\documentclass[12pt]{jsarticle}

\input{Preambles}

\def\arithmean#1{\bar{#1}}
\def\arithsum#1{#1}
\def\harmmean#1{\hat{#1}}
\def\harmformula#1#2#3{\frac{#1}{\frac{1}{#2} + \frac{1}{#3}}}

\title{調和平均}

\begin{document}

\maketitle

\section{調和平均の性質}

\begin{definition}[調和平均]
正の実数 $x_1, x_2, \ldots, x_n$,
($x_i \in \mathbb{R}, x_i > 0$) について
\begin{equation}
H = \frac{n}{\frac{1}{x_1} + \frac{1}{x_2} + \cdots \frac{1}{x_n}}
= \frac{n}{\sum_{i=1}^{n} \frac{1}{x_i}}
\end{equation}
を調和平均 (harmonic mean) と呼ぶ。
\end{definition}

\begin{definition}[相加平均]
正の実数 $x_1, x_2, \ldots, x_n$,
($x_i \in \mathbb{R}, x_i > 0$) について
\begin{equation}
A = \frac{x_1 + x_2 + \cdots x_n}{n}
= \frac{\sum_{i=1}^{n} x_i}{n}
\end{equation}
を相加平均 (または算術平均, arithmetic mean) と呼ぶ。
\end{definition}

\begin{definition}[相乗平均]
正の実数 $x_1, x_2, \ldots, x_n$,
($x_i \in \mathbb{R}, x_i > 0$) について
\begin{equation}
G = {}^{n} \sqrt{x_1 x_2 \cdots x_n}
\end{equation}
を相乗平均 (または幾何平均, geomtric mean) と呼ぶ。
\end{definition}

\begin{theorem}[平均の不等式]
\begin{equation}
H \le G \le A
\end{equation}
が成り立つ。
\end{theorem}

\begin{definition}[記号]
$n$ 個の正の実数の組
\begin{align}
(a_i, b_i), && a_i \in \mathbb{R}, b_i \in \mathbb{R},
a_i > 0, b_i >0 \qquad i = 1, 2, \ldots n
\end{align}
に対して、
\begin{align}
h_i = & \harmformula{2}{a_i}{b_i},
& {h_i}' = & \harmformula{1}{a_i}{b_i}
\end{align}
とおく。さらに、
\begin{align}
\arithsum{A_n} = & \sum_{i=1}^{n} a_i,
& \arithmean{a} = &
\frac{1}{n} \sum_{i=1}^{n} a_i
= \frac{1}{n} A_n, \\
\arithsum{B_n} = & \sum_{i=1}^{n} b_i,
& \arithmean{b} = &
\frac{1}{n} \sum_{i=1}^{n} b_i
= \frac{1}{n} B_n, \\
\arithsum{H_n} = & \sum_{i=1}^{n} {h_i}',
& \arithmean{h} = &
\frac{1}{n} \sum_{i=1}^{n} h_i
= \frac{2}{n} H_n, \\
\harmmean{H}_{n} = & \harmformula{1}{A_n}{B_n},
& \harmmean{h} = & \harmformula{2}{\arithmean{a}}{\arithmean{b}}
\end{align}
と記号を定義する。
\end{definition}

\begin{lemma}\label{lem:harmonic}
$\forall x, y, s, t > 0 (\in \mathbb{R})$ に対して
\begin{equation}
\harmformula{1}{x}{s} + \harmformula{1}{y}{t}
\le \harmformula{1}{x + y}{s + t}
\end{equation}
が成り立つ。
\end{lemma}

\begin{proof}
\begin{eqnarray}
&& (R.H.S) - (L.H.S) \nonumber \\
&=& \harmformula{1}{x + y}{s + t} -
\left( \harmformula{1}{x}{s} + \harmformula{1}{y}{t} \right) \\
&=& \frac{(x + y)(s + t)}{(x + y) + (s + t)}
- \left( \frac{x s}{x + s} + \frac{y t}{y + t} \right) \\
&=& \frac{(x + y)(s + t)}{(x + y + s + t)}
- \frac{x s (y + t) + y t (x + s)}{(x + s)(y + t)} \\
&=& \frac{(x+y)(s+t)(x+s)(y+t) - (x+y+s+t)
\left\{ xs(y+t) + yt(x+s) \right\} }
{ (x + y + s + t)(x + s)(y + t) }
\end{eqnarray}
である。分母は明らかに正だから、この分子を計算すると
\begin{eqnarray}
&& (x+y)(s+t)(x+s)(y+t) - (x+y+s+t)\left\{ xs(y+t) + yt(x+s) \right\}
\nonumber \\
&=& (xs + xt + ys + yt)(x + s)(y + t) \nonumber \\
&& - ((x + s) + (y + t)) \left\{ xs(y + t) + yt(x + s) \right\} \\
&=& xs(x + s)(y + t) + yt(x + s)(y + t) \nonumber \\
&& + xt(x + s)(y + t) + ys(x + s)(y +t) \nonumber \\
&& - (x + s)xs(y + t) - (y + t)yt(x + s) \nonumber \\
&& - (y + t)xs(y + t) - (x + s)yt(x + s) \\
&=& x t (x + s)(y + t) + y s (x + s)(y + t) - xs(y+t)^2 - yt(x+s)^2 \\
&=& xt(xy + xt + sy + st) + ys(xy + xt + sy + st) \nonumber \\
&& - xs(y^2 + 2yt + t^2) - yt(x^2 + 2xs +s^2) \\
&=& \underline{x^2yt}_{*1} + x^2t^2 + xyst + \underline{xst^2}_{*2}
+ \underline{xy^2s}_{*3} + xyst + y^2s^2 + \underline{ys^2t}_{*4} \nonumber \\
&& - \underline{xy^2s}_{*3} - 2xyst - \underline{xst^2}_{*2}
- \underline{x^2yt}_{*1} - 2xyst - \underline{ys^2t}_{*4} \\
&=& x^2t^2 - 2 xyst + y^2s^2 \\
&=& (xt - ys)^2
\end{eqnarray}
よって、
\begin{eqnarray}
&& (R.H.S) - (L.H.S) \nonumber \\
&=& \frac{(xt - ys)^2}{ (x + y + s + t)(x + s)(y +t) } \\
&\ge& 0
\end{eqnarray}
が示された。
\end{proof}

\begin{theorem}
\begin{equation}
\arithsum{H_n} \le \harmmean{H}_{n}
\end{equation}
が成り立つ。
\end{theorem}

\begin{proof}
$n$ に関する数学的帰納法で示す。
$n=1$ の時は、
\begin{equation}
\arithsum{H}_{1} = \harmformula{1}{a_1}{b_1}, \quad
\harmmean{H}_{1} = \harmformula{1}{a_1}{b_1}
\end{equation}
であるから、明らかに、
$\arithsum{H}_{1} \le \harmmean{H}_{1}$
が成り立つ。
$n = 2$ の時は、
\begin{equation}
\arithsum{H}_{2} = \harmformula{1}{a_1}{b_1} + \harmformula{1}{a_2}{b_2},
\quad
\harmmean{H}_{2} = \harmformula{1}{a_1 + a_2}{b_1 + b_2}
\end{equation}
であるから、
$x = a_1, y = a_2, s = b_1, t = b_2$ と置けば、
これは、Lemma \ref{lem:harmonic} のクレームそのもので、
$\arithsum{H_2} \le \harmmean{H}_{2}$
が成り立つ。

さて $n = k - 1$ の時に成り立つと仮定する。
すると $n = k$ の時は、
\begin{eqnarray}
\harmmean{H}_{k} &=& \harmformula{1}{A_k}{B_k} \\
&=& \harmformula{1}{A_{k-1} + a_k}{B_{k-1} + b_k} \\
\end{eqnarray}
この式に、
$x = A_{k-1}, y = a_k, s = B_{k-1}, t = b_k$ として
再び (補題 \ref{lem:harmonic}) を適用すれば、
\begin{eqnarray}
\harmmean{H}_{k}
&=& \harmformula{1}{A_{k-1} + a_k}{B_{k-1} + b_k} \nonumber \\
&\ge& \harmformula{1}{A_{k-1}}{B_{k-1}} + \harmformula{1}{a_k}{b_k} \\
&=& \harmmean{H}_{k-1} + \harmformula{1}{a_k}{b_k}
\label{eq:induction_hypotheis} \\
&\ge& \arithsum{H}_{k-1} + \harmformula{1}{a_k}{b_k}
\label{eq:induction_consequent} \\
&=& \sum_{i=1}^{k-1} {h_i}' + {h_k}'
= \sum_{i=1}^{k} {h_i} = \arithsum{H}_{k}
\end{eqnarray}
ここで、式 (\ref{eq:induction_hypotheis}) から
式 (\ref{eq:induction_consequent}) への変形で、帰納法の仮定を適用した。
これで、$n = k$ の時も
$\arithsum{H}_{k} \le \harmmean{H}_{k}$
が成立することが示された。
\end{proof}

\begin{corollary}
調和平均と相加平均に関して、
\begin{equation}
\arithmean{h} \le \harmmean{h}
\end{equation}
が成り立つ。i.e.,
ペア毎に調和平均をとってから相加平均を取ったものは、
先に $a$ 列 $b$ 列で相加平均を取ってから調和平均を取ったものより
大きくはない。
\end{corollary}


\end{document}
